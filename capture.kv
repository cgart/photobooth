#:kivy 1.0
#:import kivy kivy
#:import win kivy.core.window

FloatLayout:
    id: main_layout
    size_hint: (1.0, 1.0)
        
    canvas:
        Color:
            rgb: 1, 1, 0.3
        Rectangle:
            source: 'data/background.jpg'
            size: self.size

                    
    # Widget holding all available slots to show previous images
    # all slots are children widget on the same level
    CapturedSlots:
        id: picture_slots
        layout: pic_layout
        
        RelativeLayout:
            id: pic_layout
            size: root.size
            pos: root.pos
        
            canvas:
                Color:
                    rgba: 0,1,1,0.3   
                Rectangle:
                    pos: self.pos
                    size: self.size
            
            Picture:
                pos_hint: {'right':0.95, 'top':0.95}
                scale: 1.0
                
            
    Preview:
        id: camera_image
        
    WhiteBillboard:
        id: white_overlay
        
<Widget>:
    canvas.after:
        Line:
            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
            dash_offset: 5
            dash_length: 3

# ----------------------------------------------------------------------            
# Big white flash on the screen
# ----------------------------------------------------------------------            
<CapturedSlots>
    size_hint: 1.0, 1.0
    
# ----------------------------------------------------------------------            
# Big white flash on the screen
# ----------------------------------------------------------------------            
<WhiteBillboard>
    size_hint: 1.0, 1.0
    
    canvas:
        Color:
            rgba: 1,1,1,self.alpha   
        Rectangle:
            pos: self.pos
            size: self.size

                        
# ----------------------------------------------------------------------            
# Preview image defintion
# ----------------------------------------------------------------------            
<Preview>:
    size: image.size
    size_hint: None, None
    #pos_hint: {'center_x':0.5, 'center_y':0.5}
    pos_hint: {'x':0.025, 'top':0.95}
    
    # pass down to python the Image by the label preview_image
    preview_image: image
                    
    Image:
        id: image
        texture: root.image.texture
        x: self.parent.x
        y: self.parent.y
        
        # create initial image to be 400 pixels width
        size: 640, 640 / self.image_ratio
        
        # add shadow background
        canvas.before:
            Color:
                rgba: 1,1,1,1
            BorderImage:
                source: 'data/shadow32.png'
                border: (36,36,36,36)
                size:(self.width+72, self.height+72)
                pos: (self.x - 36, self.y - 36)
        
# ----------------------------------------------------------------------            
# Any captured image defintion
# ----------------------------------------------------------------------            
<Picture>:
    #size_hint: image.size[0]/root.size[0], image.size[1]/root.size[1]
    #size_hint: 0.1,0.1
    #size: image.size
            
    Image:
        id: image
        texture: root.image.texture
        color: 1,1,1,root.alpha
        
        # create initial image to be 400 pixels width
        #size: 640, 360
        size: 640, 640 / self.image_ratio
        pos: 0,0
        
        # add shadow background
        canvas.before:
            Color:
                rgba: 1,1,1,root.alpha
            BorderImage:
                source: 'data/shadow32.png'
                border: (36,36,36,36)
                size:(self.width+72, self.height+72)
                pos: (-36,-36)


# ----------------------------------------------------------------------            
# Numbers for the countdown
# ----------------------------------------------------------------------            
<CounterNum>:
    
    size_hint: None, None
    pos_hint: {'center_x':0.5, 'center_y':0.5}
    
    canvas:
        Color:
            rgba: 1.0,1,1.0,0.75
        Rectangle:
            pos: self.pos
            size: self.size
            texture: root.label_texture
            
            
